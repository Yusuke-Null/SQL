# コーディングの指針
### コメント
SQLにおいては以下の理由でコメントはあったほうがよい(可動性が下がるから読めるようコーディングしろ派もいる)  
1. SQLは宣言型言語であるため、同じ処理を記述するにも手続き型言語と比べて凝縮されたコードに多くの処理を詰め込む
-> 手続き型言語ほどコードに語らせるコードを書くのが難しい
2. SQLでは段階的なデバッグがほとんどできない
-> コード解析時には手続き型言語より机上デバッグに頼ることが多い(相関サブクエリを使うべきでない理由はこれ)

コメントの書き方の例
- 1行コメント(--)
``` sql
-- SomeTableからcol_1を選択する
SELECT col_1
FROM
	SomeTable;
```
- 複数行コメント(/* */)
``` sql
/*
SomeTableからcol_1を選択する
*/
SELECT col_1
FROM
	SomeTable;
```
他にもSQLにコメントを入れたりできる(条件式の説明などに便利)  
コードと同じ行にも書ける
``` sql
SELECT col_1 FROM SomeTable
WHERE
	col_1 = 'a'
AND
	col_2 = 'b'
-- 以下の条件はcol_3が'c'、'd'のいずれかであることを指定します
AND
	col_3 IN('c','d')

SELECT col_1 --SomeTableからcol_1を選択する
FROM
	SomeTable;
```

### インデント
以下を意識するとよい  
- 「サブ(下位)」の意味の通り、サブクエリはインデントを一段下げる
- SELECT句やGROUP BY句で複数列指定する場合は1レベル下げる  
-> 句の区切りが明確になる。行数が気になる場合は、3列ごととか意味のある単位でまとめるなどする
``` sql
-- 良い列
SELECT col_1
	,col2, col_3
	,COUNT(*)
 FROM tbl_A
WHERE col_1 = 'a'
	AND col2 = ( SELECT MAX(col_2)
			 FROM tbl_B
			WHERE col_3 = 100 )
GROUP BY col_1
	,col_2
	,col_3;

-- 悪い例
SELECT col_1,col2,col_3,COUNT(*)
FROM tbl_A
WHERE col_1 = 'a'
AND col2 = (SELECT MAX(col_2)
			FROM tbl_B
			WHERE col_3 = 100
			) GROUP BY col_1,col_2,col_3;
```
悪い見本ではGROUP BYで行を切り替えてないが、句は明確な役割を担っているため、この単位で改行を入れる
``` sql
SELECT
FROM
WHERE
GROUP BY
HAVING
ORDER BY
```

### スペース
コードには適度なスペースがあるほうが読みやすく、意味的な単位も明確になる  
構文エラーにはならないが、可動性の観点から要素を明示的に区切った方が良い
``` sql
-- 良い例
SELECT col_1
FROM tbl_A AS A INNER JOIN tbl_B AS B
	ON A.col_3 = B.col_3
WHERE ( Acol_1 >= 100 OR A.col_2 IN( 'a','b' ) );

-- 悪い例
SELECT col_1
FROM tbl_A AS A INNER JOIN tbl_B AS B
	ON A.col_3=B.col_3
WHERE (Acol_1>=100 OR A.col_2 IN('a','b'));
```
