# 練習問題
03_クロス表で入れ子の表側を作るで以下のクエリを使用した。  
しかし、パフォーマンス的には中間ビューを2度使うのは良くないため、減らしたい
``` sql
SELECT
	master.age_class AS age_class
	,master.sex_cd AS sex_cd
	,data.pop_tohoku AS pop_tohoku
	,data.pop_kanto AS pop_kanto
FROM
	(SELECT
		age_class
		,sex_cd
	 FROM
		Chapter8TblAge
	 CROSS JOIN
		Chapter8TblSex) AS master
LEFT JOIN
	(SELECT
		age_class
		,sex_cd
		,SUM(CASE
				WHEN pref_name IN('青森','秋田') THEN population
				ELSE NULL
				END) AS pop_tohoku
		,SUM(CASE
				WHEN pref_name IN('東京','千葉') THEN population
				ELSE NULL
				END) AS pop_kanto
	FROM
		Chapter8TblPop
	GROUP BY
		age_class
		,sex_cd) AS data
ON
	master.age_class = data.age_class
AND
	master.sex_cd = data.sex_cd
ORDER BY
	master.age_class
```
結果
|age_class|sex_cd|pop_tohoku|pop_kanto|
|:----|:----|:----|:----|
|1|f|1300|2500|
|1|m|1100|1800|
|2|f|NULL|NULL|
|2|m|NULL|NULL|
|3|f|1800|2100|
|3|m|1000|NULL|

以下の様にして減らす
``` sql

```
