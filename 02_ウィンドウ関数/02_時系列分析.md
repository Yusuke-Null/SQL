# 時系列分析
時系列に従って、1行ずつ過去へ遡るか、未来へ進むSQL  
Ex) サーバーの時間ごとの負荷量を記録したテーブルから過去の直近日付データを出力する  
PRECEDINGは前の行、FOLLOWINGは後の行
``` SQL
-- FOLLOWING
SELECT
	sample_date as cur_date
	,load_val as cur_load
	,MIN(sample_date) OVER (
		ORDER BY sample_date ASC
		ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS latest_date
	,MIN(load_val) OVER (
		ORDER BY sample_date ASC
		ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS latest_load
FROM
	Chapter2LoadSample

-- result
cur_date	cur_load	latest_date	latest_load
2018-02-01	1024	NULL	NULL
2018-02-02	2366	2018-02-01	1024
2018-02-05	2366	2018-02-02	2366
2018-02-07	985	2018-02-05	2366
2018-02-08	780	2018-02-07	985
2018-02-12	1000	2018-02-08	780

-- FOLLOWING
SELECT
	sample_date as cur_date
	,load_val as cur_load
	,MIN(sample_date) OVER (
		ORDER BY sample_date ASC
		ROWS BETWEEN 1 FOLLOWING AND 1 FOLLOWING) AS latest_date
	,MIN(load_val) OVER (
		ORDER BY sample_date ASC
		ROWS BETWEEN 1 FOLLOWING AND 1 FOLLOWING) AS latest_load
FROM
	Chapter2LoadSample

-- result
cur_date	cur_load	latest_date	latest_load
2018-02-01	1024	2018-02-02	2366
2018-02-02	2366	2018-02-05	2366
2018-02-05	2366	2018-02-07	985
2018-02-07	985	2018-02-08	780
2018-02-08	780	2018-02-12	1000
2018-02-12	1000	NULL	NULL
```
