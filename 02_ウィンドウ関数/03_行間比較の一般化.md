# 行間比較の一般化
Window関数の正体は内部でレコード集合に対してソートを行っているため、ソートである  
→ PARTITION BYのグループの分類であれ、ORDER BYであれソートが必要になるため  
``` SQL
SELECT
	sample_date as cur_date
	,MIN(sample_date) OVER(
		ORDER BY sample_date
		ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) as latest_1
	,MIN(sample_date) OVER(
		ORDER BY sample_date
		ROWS BETWEEN 2 PRECEDING AND 2 PRECEDING) as latest_2
	,MIN(sample_date) OVER(
		ORDER BY sample_date
		ROWS BETWEEN 3 PRECEDING AND 3 PRECEDING) as latest_3
FROM
	Chapter2LoadSample

-- result
cur_date	latest_1	latest_2	latest_3
2018-02-01	NULL	NULL	NULL
2018-02-02	2018-02-01	NULL	NULL
2018-02-05	2018-02-02	2018-02-01	NULL
2018-02-07	2018-02-05	2018-02-02	2018-02-01
2018-02-08	2018-02-07	2018-02-05	2018-02-02
2018-02-12	2018-02-08	2018-02-07	2018-02-05
```
