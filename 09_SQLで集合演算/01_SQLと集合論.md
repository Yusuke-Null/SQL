# SQLと集合論
SQLの集合演算子は名前の通り「集合」を取る演算子である  
-> 実装レベルではテーブルやビューを引数に取る演算のこと  
ただし、SQLでは独特な特徴があるため注意が必要
## 注意点
### 重複行を許す多重集合のため、Allオプションが存在する
通常の集合論は重複を認めていないことから{1,1,2,2,3}は{1,2,3}と同じとみなされる  
ただRDBのテーブルは重複行を認める多重集合のため  
SQLの集合演算子は重複を認めるバージョンと認めないバージョンの2通りが用意されている  
UNIONやINTERSECT(内部結合)をそのまま使うと結果から重複行を削除する  
重複行を残す場合はUNION ALLのようにALLオプションを付ける  

**2パターンの違いは結果だけでなく、ALLを付けたほうがパフォーマンスが向上する  
-> 集合演算子は重複排除のために暗黙のソートが発生するが、ALLを付けるとソートが行われないため**  
よって重複を気にしなくてよい場合や、重複が発生しないことが確実な場合はALLを付けるといい

### 演算の順番に優先順位がある  
標準SQLではUNIONやEXCEPTに対してINTERSECTの方が先に実行されるよう定められている  
そのため、UNIONとINTERSECTを併用時にUNIONを優先的に実行した場合は括弧を付けて明示的に演算の順序を指定する必要がある  

### DBMSごとに集合演算子の実装状況にばらつきがある
初期のSQLが集合演算の整備を怠ってきたツケによるもの  
実装されていなかったり、OracleではEXCEPTがMINUSという名前で持っていたりなど

### 除算の標準的な定義がない
四則演算の内、和(UNION)、差(EXCEPT)、積(CROSS JOIN)は標準で入っているが  
商(DIVIDE BY)は標準化が遅れているため、除算をする際は自前のクエリが必要になる
