# 差集合で関係除算を表現する
SQLには除算の演算子がないため、自前のクエリが必要で代表的なのは以下
1. NOT EXISTSを入れ子にする
2. HAVING句を使った一対一対応を利用する
3. 割り算を引き算で表現する

ここで取り上げるのは3の方法で差集合を外部結合で表現する問題の解答と解説でもある  
| Chapter9EmpSkills |         |       |   | Chapter9Skills |       |
|------------------|---------|-------|---|----------------|-------|
| emp              | skill   |       |   | skill          |       |
| 相田             | Oracle  |       |   | Oracle         |       |
| 相田             | UNIX    |       |   | UNIX           |       |
| 相田             | Java    |       |   | Java           |       |
| 相田             | C#      |       |   |                |       |
| 神崎             | Oracle  |       |   |                |       |
| 神崎             | UNIX    |       |   |                |       |
| 神崎             | Java    |       |   |                |       |
| 平井             | UNIX    |       |   |                |       |
| 平井             | Oracle  |       |   |                |       |
| 平井             | PHP     |       |   |                |       |
| 平井             | Perl    |       |   |                |       |
| 平井             | C++     |       |   |                |       |
| 若田部           | Perl    |       |   |                |       |
| 渡来             | Oracle  |       |   |                |       |

EX) EmpSkillｓからSkillsすべてに精通した社員を探す  
``` sql
SELECT DISTINCT e1.emp
FROM Chapter9EmpSkills e1
WHERE
	NOT EXISTS
	(SELECT skill FROM Chapter9Skills AS s
	 EXCEPT
	 SELECT skill FROM Chapter9EmpSkills AS e2
	 WHERE
		e1.emp = e2.emp)

-- result
emp
神崎
相田
```
ポイントはEXCEPT演算子と相関サブクエリにある  
- 相関サブクエリは引き算を社員ごとに行うために使っていて  
- EXCEPTは要求されるスキルの集合から引き算するために使っている  
→ 残る行がなく空集合なら全てのスキルがあったとなる

上記のクエリは手続き型言語のコントロールブレイクのループ処理に似ている
→ スキルがあれば引き算し、スキルがなくなったら次の社員に同じ処理をする
